
Edge = LOAD "edge.txt" AS (source:int, dest:int);
Reachable = Edge;

DO
  _A = JOIN Reachable BY dest, Edge BY source;
  NewlyReachable = FOREACH _A EMIT (Reachable.source, Edge.dest) AS
      (source:int, dest:int);
  Reachable = UNION NewlyReachable, Reachable;
WHILE DIFF NewlyReachable, Reachable;

DUMP Reachable;
